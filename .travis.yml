language: rust

cache: cargo
before_cache:
  - rm -rf "$TRAVIS_HOME/.cargo/registry/src"

rust:
  - stable

script:
  - cargo build --verbose --all
  - cargo test --verbose --all

before_deploy:
  - cargo build --release
  - strip ./target/release/escl-scan

deploy:
  provider: releases
  api_key: $OAUTH_KEY
  file: "./target/release/escl-scan"
  skip_cleanup: true
  on:
    tags: true
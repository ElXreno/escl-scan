os: linux
language: rust

cache: cargo
before_cache:
  - rm -rf "$TRAVIS_HOME/.cargo/registry/src"

rust:
  - stable

script:
  - bash <(curl -s https://codecov.io/bash)
  - cargo build --verbose --locked --all-targets --all-features
  - cargo test --verbose --locked --all-targets --all-features

deploy:
  provider: cargo
  token: $OAUTH_KEY
  on:
    tags: true
